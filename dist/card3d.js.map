{"version":3,"file":"card3d.js","sources":["../src/core/card3d.ts","../src/utils.ts","../src/core/attr-handler.ts","../src/core/observer.ts","../src/index.ts"],"sourcesContent":["import {\n  findCardIndex,\n  parseBooleanAttribute,\n  parseFloatAttrbiutes,\n} from \"utils\";\nimport Config from \"../types/config\";\nimport EventListener from \"../types/eventListener\";\n\nconst Card3dElements: { element: HTMLElement; instance: Card3d }[] = [];\n\nconst defaultConfig = {\n  delta: 10,\n  perspective: 500,\n  startX: 0,\n  startY: 0,\n  glareOpacity: 0.5,\n  axis: \"all\",\n  scale: 1,\n} as const satisfies Config;\n\nclass Card3d {\n  private glareElement: HTMLElement;\n  private focusElement: HTMLElement;\n\n  private gyroOrigin: { x: number; y: number } = null;\n\n  private eventMouseMoove: EventListener<MouseEvent>;\n  private eventMouseOut: EventListener<MouseEvent>;\n  private eventDeviceOrientation: EventListener<DeviceOrientationEvent>;\n\n  constructor(private card3dElement: HTMLElement, public config?: Config) {\n    Card3dElements.push({ element: card3dElement, instance: this });\n\n    if (!this.config) this.config = this.setConfigFromAttributes();\n\n    this.config = Object.assign({}, defaultConfig, this.config);\n\n    if (!this.config.stop) this.start();\n    else this.stop();\n  }\n\n  /**\n   * Update config when attributes change\n   */\n  updateConfig() {\n    this.config = this.setConfigFromAttributes();\n\n    if (this.config.stop) {\n      this.stop();\n    } else {\n      this.reset();\n      this.start();\n    }\n  }\n\n  /**\n   * Set the configuration based on the attributes\n   * @returns\n   */\n  private setConfigFromAttributes(): Config {\n    const attr = this.card3dElement.dataset;\n\n    const fullPageListening = parseBooleanAttribute(\n      attr.card3dFullPageListening\n    );\n    const noReset = parseBooleanAttribute(attr.card3dNoReset);\n    const glare = parseBooleanAttribute(attr.card3dGlare);\n    const reverse = parseBooleanAttribute(attr.card3dReverse);\n    const stop = parseBooleanAttribute(attr.card3dStop);\n    const gyroscopie = parseBooleanAttribute(attr.card3dGyroscopie);\n\n    const delta = parseFloatAttrbiutes(attr.card3dDelta) ?? defaultConfig.delta;\n    const perspective =\n      parseFloatAttrbiutes(attr.card3dPerspective) ?? defaultConfig.perspective;\n    const startX =\n      parseFloatAttrbiutes(attr.card3dStartX) ?? defaultConfig.startX;\n    const startY =\n      parseFloatAttrbiutes(attr.card3dStartY) ?? defaultConfig.startY;\n    const glareOpacity =\n      parseFloatAttrbiutes(attr.card3dGlare) ?? defaultConfig.glareOpacity;\n    const scale = parseFloatAttrbiutes(attr.card3dScale) ?? defaultConfig.scale;\n\n    let axis: Config[\"axis\"] = \"all\";\n    if (attr.card3dAxis === \"x\") {\n      axis = \"x\";\n    } else if (attr.card3dAxis === \"y\") {\n      axis = \"y\";\n    }\n\n    return {\n      gyroscopie,\n      stop,\n      scale,\n      delta,\n      axis,\n      noReset,\n      reverse,\n      fullPageListening,\n      perspective,\n      startX,\n      startY,\n      glare,\n      glareOpacity,\n    };\n  }\n\n  /**\n   * Remove all event listener of the card\n   */\n  private removeEventListener() {\n    this.focusElement.removeEventListener(\"mousemove\", this.eventMouseMoove);\n    this.focusElement.removeEventListener(\"mouseout\", this.eventMouseOut);\n    if (this.config.gyroscopie)\n      window.removeEventListener(\n        \"deviceorientation\",\n        this.eventDeviceOrientation\n      );\n  }\n\n  /**\n   * Set all necessary event listener\n   */\n  private setupEventListener() {\n    this.eventMouseMoove = (event: MouseEvent) => this.mousemove(event);\n    this.eventMouseOut = () => this.mouseout();\n\n    this.focusElement.addEventListener(\"mousemove\", this.eventMouseMoove);\n    if (!this.config.noReset) {\n      this.focusElement.addEventListener(\"mouseout\", this.eventMouseOut);\n    }\n\n    if (this.config.gyroscopie) {\n      this.eventDeviceOrientation = (event: DeviceOrientationEvent) =>\n        this.gyro(event);\n      window.addEventListener(\"deviceorientation\", this.eventDeviceOrientation);\n    }\n  }\n\n  /**\n   * Handle device orientation event\n   * @param event\n   * @returns\n   */\n  private gyro(event: DeviceOrientationEvent) {\n    const rotateZ = event.beta,\n      rotateX = event.gamma;\n\n    if (typeof rotateX !== \"number\" || typeof rotateZ !== \"number\") return;\n\n    this.mousemove({\n      clientY: rotateZ / 45,\n      clientX: rotateX / 45,\n      gyroscopie: true,\n    });\n  }\n\n  /**\n   * Remove the card from the list, set attribute stop and reset it\n   */\n  stop() {\n    const cardIndex = findCardIndex(this.card3dElement);\n    Card3dElements.splice(cardIndex, 1);\n    this.card3dElement.setAttribute(\"data-card3d-stop\", \"true\");\n    this.reset();\n  }\n\n  /**\n   * Reset the card style and remove event listener\n   */\n  reset() {\n    this.card3dElement.style.transform = \"\";\n    this.card3dElement.style.transition = \"\";\n\n    if (this.glareElement) this.glareElement.remove();\n\n    this.removeEventListener();\n  }\n\n  /**\n   * Apply the glare\n   */\n  applyGlare() {\n    this.glareElement = document.createElement(\"span\");\n    this.glareElement.setAttribute(\n      \"style\",\n      `\n        will-change: transform;\n        position: absolute;\n        background-image: linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%);\n        pointer-event: none; \n        transform-origin: 0% 0%;\n        transform: translate(-50%, -50%) rotate(180deg);\n        opacity: 0;\n        z-index: 999;\n        `\n    );\n    this.card3dElement.appendChild(this.glareElement);\n  }\n\n  /**\n   * Init the card by setting event and creating glare effect\n   */\n  start() {\n    this.focusElement = this.config.fullPageListening\n      ? document.body\n      : this.card3dElement;\n\n    this.setupEventListener();\n    if (this.config.glare) this.applyGlare();\n\n    this.card3dElement.style.overflow = \"hidden\";\n    this.card3dElement.style.willChange = \"transform\";\n    this.card3dElement.style.transform = `\n        perspective(500px) \n        rotateX(${this.config.startY}deg) \n        rotateY(${this.config.startX}deg)\n        `;\n  }\n\n  /**\n   * Event that handle all mouse event\n   * @param event\n   * @returns\n   */\n  private mousemove(\n    event:\n      | MouseEvent\n      | { clientX: number; clientY: number; gyroscopie: boolean }\n  ) {\n    if (!this.card3dElement.isConnected || !this.focusElement.isConnected) {\n      this.stop();\n      return;\n    }\n\n    this.card3dElement.style.transition = \"\";\n\n    const config = this.config;\n    const reverse = config.reverse ? 1 : -1;\n\n    const rect = this.card3dElement.getBoundingClientRect();\n\n    const middleWidth = rect.width / 2;\n    const middleHeight = rect.height / 2;\n    const middleX = rect.left + middleWidth;\n    const middleY = rect.top + middleHeight;\n\n    const x = (middleX - event.clientX) * -1;\n    const y = middleY - event.clientY;\n\n    const width =\n      this.focusElement !== this.card3dElement\n        ? window.innerWidth / 2\n        : rect.width / 2;\n    const height =\n      this.focusElement !== this.card3dElement\n        ? window.innerHeight / 2\n        : rect.height / 2;\n\n    let finalX: number = 0,\n      finalY: number = 0;\n\n    if (\"gyroscopie\" in event) {\n      if (!this.gyroOrigin) {\n        this.gyroOrigin = {\n          x: event.clientX,\n          y: event.clientY,\n        };\n      }\n\n      finalX = (this.gyroOrigin.x - event.clientX) * config.delta;\n      finalY = (this.gyroOrigin.y - event.clientY) * config.delta;\n    } else {\n      if (config.axis !== \"y\") {\n        finalX = (x / width) * config.delta;\n      }\n\n      if (config.axis !== \"x\") {\n        finalY = (y / height) * config.delta;\n      }\n    }\n\n    //we update the glare\n    if (config.glare) {\n      const angle =\n        Math.atan2(event.clientX - middleX, -(event.clientY - middleY)) *\n        (180 / Math.PI);\n      const glareSize =\n        (rect.width > rect.height ? rect.width : rect.height) * 2;\n      this.glareElement.style.opacity = config.glareOpacity.toString();\n      this.glareElement.style.left = \"50%\";\n      this.glareElement.style.top = \"50%\";\n      this.glareElement.style.width = glareSize + \"px\";\n      this.glareElement.style.height = glareSize + \"px\";\n      this.glareElement.style.transform = `rotate(${angle}deg) translate(-50%, -50%)`;\n      this.glareElement.style.display = \"block\";\n    }\n\n    //we apply the transformation to the card\n    this.card3dElement.style.transform = `\n        perspective(${config.perspective}px) \n        rotateX(${finalY * reverse}deg) \n        rotateY(${finalX * reverse}deg)\n        scale(${config.scale})\n        `;\n  }\n\n  /**\n   * Event that handle when mouse out of the card\n   * @param event\n   */\n  private mouseout() {\n    this.card3dElement.style.transition = \"0.5s ease\";\n    this.card3dElement.style.transform = \"\";\n    if (this.glareElement) this.glareElement.style.opacity = \"0\";\n  }\n}\n\nexport { Card3d, Card3dElements };\n","import { Card3dElements } from \"core/card3d\";\r\n\r\n/**\r\n * Parse boolean from attribute\r\n * @param str\r\n * @returns\r\n */\r\nfunction parseBooleanAttribute(str: string): boolean {\r\n  return str !== null && str !== undefined && (str === \"\" || str === \"true\");\r\n}\r\n\r\n/**\r\n * Parse float from attribute\r\n * @param str\r\n * @returns\r\n */\r\nfunction parseFloatAttrbiutes(str: string): number {\r\n  const nb = parseFloat(str);\r\n  return isNaN(nb) || typeof nb !== \"number\" ? undefined : nb;\r\n}\r\n\r\n/**\r\n * Find the card index\r\n * @param cardElement\r\n * @returns\r\n */\r\nfunction findCardIndex(cardElement: HTMLElement | Node) {\r\n  return Card3dElements.findIndex((e) => e.element === cardElement);\r\n}\r\n\r\nexport { parseBooleanAttribute, parseFloatAttrbiutes, findCardIndex };\r\n","import { findCardIndex, parseBooleanAttribute } from \"../utils\";\r\nimport { Card3d, Card3dElements } from \"./card3d\";\r\n\r\n/**\r\n * Check the card and create the card\r\n * @param card3dList\r\n * @returns\r\n */\r\nfunction Card3dAttributesHandler(\r\n  card3dList: HTMLElement[] | NodeListOf<HTMLElement>\r\n) {\r\n  for (const card3d of card3dList) {\r\n    const alreadySetup = findCardIndex(card3d) !== -1;\r\n    const isNotCard3d = card3d.dataset?.card3d === undefined;\r\n    const isStopped = parseBooleanAttribute(card3d.dataset?.card3dStop);\r\n\r\n    if (alreadySetup || isStopped || isNotCard3d) continue;\r\n\r\n    new Card3d(card3d);\r\n  }\r\n}\r\n\r\nexport default Card3dAttributesHandler;\r\n","import { findCardIndex, parseBooleanAttribute } from \"utils\";\r\nimport { Card3dElements } from \"./card3d\";\r\nimport Card3dAttributesHandler from \"./attr-handler\";\r\n\r\n/**\r\n * Create the observer to add new card, remove card or change card on attribute change\r\n */\r\nfunction Card3dObserver() {\r\n  const observerDOM = new MutationObserver(function (mutations) {\r\n    const addedNodes: HTMLElement[] = [];\r\n\r\n    for (const mutation of mutations ?? []) {\r\n      //attributes changed\r\n      if (\r\n        mutation.type === \"attributes\" &&\r\n        mutation.attributeName.includes(\"data-card3d\")\r\n      ) {\r\n        const element = mutation.target as HTMLElement;\r\n        const cardIndex = findCardIndex(element);\r\n\r\n        const isNewCard =\r\n          parseBooleanAttribute(element.dataset?.card3d) && cardIndex === -1;\r\n        const cardAlreadyExist = cardIndex !== -1;\r\n\r\n        if (isNewCard) {\r\n          addedNodes.push(element);\r\n        } else if (cardAlreadyExist) {\r\n          Card3dElements[cardIndex].instance.updateConfig();\r\n        }\r\n      }\r\n\r\n      //added nodes\r\n      for (const addedNode of mutation.addedNodes) {\r\n        addedNodes.push(addedNode as HTMLElement);\r\n      }\r\n\r\n      //removed nodes\r\n      for (const removedNode of mutation.removedNodes) {\r\n        const elementIndex = findCardIndex(removedNode);\r\n        if (elementIndex !== -1) Card3dElements.splice(elementIndex, 1);\r\n      }\r\n    }\r\n\r\n    if (addedNodes.length > 0) Card3dAttributesHandler(addedNodes);\r\n  });\r\n\r\n  observerDOM.observe(window.document.documentElement, {\r\n    childList: true,\r\n    subtree: true,\r\n    attributes: true,\r\n  });\r\n}\r\n\r\nexport default Card3dObserver;\r\n","import Card3dObserver from \"core/observer\";\r\nimport Card3dAttributesHandler from \"core/attr-handler\";\r\nimport { Card3d } from \"core/card3d\";\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n  Card3dAttributesHandler(document.querySelectorAll(\"[data-card3d]\"));\r\n  Card3dObserver();\r\n});\r\n\r\nexport default Card3d;\r\n"],"names":[],"mappings":"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"}