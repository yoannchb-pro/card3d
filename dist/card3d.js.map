{"version":3,"file":"card3d.js","sources":["../src/card3d.ts"],"sourcesContent":["import Config from \"../types/config\";\nimport EventListener from \"../types/eventListener\";\n\n//Register all intance of 3dcard element\nconst Card3dElements: { element: HTMLElement; instance: Card3d }[] = [];\n\n/**\n * Parse boolean from attribute\n * @param str\n * @returns\n */\nfunction parseBooleanAttribute(str: string): boolean {\n  return str !== null && str !== undefined && (str === \"\" || str === \"true\");\n}\n\n/**\n * Parse float from attribute\n * @param str\n * @returns\n */\nfunction parseFloatAttrbiutes(str: string): number {\n  const nb = parseFloat(str);\n  return isNaN(nb) || typeof nb !== \"number\" ? undefined : nb;\n}\n\nclass Card3d {\n  private glareElement: HTMLElement;\n  private focusElement: HTMLElement;\n  private eventMouseMoove: EventListener;\n  private eventMouseOut: EventListener;\n  private eventDeviceOrientation: (\n    this: HTMLElement,\n    ev: DeviceOrientationEvent\n  ) => any;\n\n  constructor(private card3dElement: HTMLElement, public config?: Config) {\n    //we register the element\n    Card3dElements.push({ element: card3dElement, instance: this });\n\n    //we set the config from the attributes\n    if (!this.config) this.config = this.setConfigFromAttributes();\n\n    //default config\n    this.config = Object.assign(\n      {\n        delta: 10,\n        perspective: 500,\n        startX: 0,\n        startY: 0,\n        glareOpacity: 0.5,\n        axis: \"all\",\n        scale: 1,\n      },\n      this.config\n    );\n\n    //start the card listening to events\n    if (!this.config.stop) this.start();\n    else this.stop();\n  }\n\n  /**\n   * Update config when attributes change\n   */\n  updateConfig() {\n    this.config = this.setConfigFromAttributes();\n\n    if (this.config.stop) {\n      this.stop();\n    } else {\n      this.reset();\n      this.start();\n    }\n  }\n\n  /**\n   * Set the configuration based on the attributes\n   * @returns\n   */\n  private setConfigFromAttributes(): Config {\n    const attr = this.card3dElement.dataset;\n\n    const fullPageListening = parseBooleanAttribute(\n      attr.card3dFullPageListening\n    );\n    const noReset = parseBooleanAttribute(attr.card3dNoReset);\n    const glare = parseBooleanAttribute(attr.card3dGlare);\n    const reverse = parseBooleanAttribute(attr.card3dReverse);\n    const stop = parseBooleanAttribute(attr.card3dStop);\n    const gyroscopie = parseBooleanAttribute(attr.card3dGyroscopie);\n\n    const delta = parseFloatAttrbiutes(attr.card3dDelta) ?? 10;\n    const perspective = parseFloatAttrbiutes(attr.card3dPerspective) ?? 500;\n    const startX = parseFloatAttrbiutes(attr.card3dStartX) ?? 0;\n    const startY = parseFloatAttrbiutes(attr.card3dStartY) ?? 0;\n    const glareOpacity = parseFloatAttrbiutes(attr.card3dGlare) ?? 0.5;\n    const scale = parseFloatAttrbiutes(attr.card3dScale) ?? 1;\n\n    let axis: Config[\"axis\"] = \"all\";\n    if (attr.card3dAxis === \"x\") {\n      axis = \"x\";\n    } else if (attr.card3dAxis === \"y\") {\n      axis = \"y\";\n    }\n\n    return {\n      gyroscopie,\n      stop,\n      scale,\n      delta,\n      axis,\n      noReset,\n      reverse,\n      fullPageListening,\n      perspective,\n      startX,\n      startY,\n      glare,\n      glareOpacity,\n    };\n  }\n\n  /**\n   * Reset the card and stop events\n   */\n  stop() {\n    Card3dElements.splice(\n      Card3dElements.findIndex((e) => e.element === this.card3dElement),\n      1\n    );\n    this.card3dElement.setAttribute(\"data-card3d-stop\", \"true\");\n    this.reset();\n  }\n\n  /**\n   * Reset the card\n   */\n  reset() {\n    this.card3dElement.style.transform = \"\";\n    this.card3dElement.style.transition = \"\";\n    this.focusElement.removeEventListener(\"mousemove\", this.eventMouseMoove);\n    this.focusElement.removeEventListener(\"mouseout\", this.eventMouseOut);\n    if (this.config.gyroscopie)\n      window.removeEventListener(\n        \"deviceorientation\",\n        this.eventDeviceOrientation\n      );\n    if (this.glareElement) this.glareElement.remove();\n  }\n\n  /**\n   * Init the card by setting event and creating glare effect\n   */\n  start() {\n    const card3dElement = this.card3dElement;\n\n    //set the focus element for full page listening\n    this.focusElement = card3dElement;\n    if (this.config.fullPageListening) this.focusElement = document.body;\n\n    if (this.config.glare) {\n      this.glareElement = document.createElement(\"span\");\n      this.glareElement.setAttribute(\n        \"style\",\n        `\n        will-change: transform;\n        position: absolute;\n        background-image: linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%);\n        pointer-event: none; \n        transform-origin: 0% 0%;\n        transform: translate(-50%, -50%) rotate(180deg);\n        opacity: 0;\n        z-index: 999;\n        `\n      );\n      card3dElement.appendChild(this.glareElement);\n    }\n\n    this.eventMouseMoove = (event: MouseEvent) => this.mousemove(event);\n    this.eventMouseOut = (event: MouseEvent) => this.mouseout(event);\n\n    //event setup\n    this.focusElement.addEventListener(\"mousemove\", this.eventMouseMoove);\n    if (!this.config.noReset) {\n      this.focusElement.addEventListener(\"mouseout\", this.eventMouseOut);\n    }\n    if (this.config.gyroscopie) {\n      this.eventDeviceOrientation = (event: DeviceOrientationEvent) => {\n        const rotateZ = event.beta,\n          rotateX = event.gamma;\n        if (typeof rotateX !== \"number\" || typeof rotateZ !== \"number\") return;\n        this.mousemove({\n          clientY: Math.min(rotateZ / 45, 1),\n          clientX: Math.min(rotateX / 45, 1),\n          gyroscopie: true,\n        });\n      };\n      window.addEventListener(\"deviceorientation\", this.eventDeviceOrientation);\n    }\n\n    card3dElement.style.overflow = \"hidden\";\n    card3dElement.style.willChange = \"transform\";\n    card3dElement.style.transform = `\n        perspective(500px) \n        rotateX(${this.config.startY}deg) \n        rotateY(${this.config.startX}deg)\n        `;\n  }\n\n  /**\n   * Event that handle all mouse event\n   * @param event\n   * @returns\n   */\n  mousemove(\n    event:\n      | MouseEvent\n      | { clientX: number; clientY: number; gyroscopie: boolean }\n  ) {\n    const config = this.config;\n\n    if (!this.card3dElement.isConnected || !this.focusElement.isConnected) {\n      this.stop();\n      return;\n    }\n\n    const reverse = config.reverse ? 1 : -1;\n\n    this.card3dElement.style.transition = \"\";\n\n    const rect = this.card3dElement.getBoundingClientRect();\n\n    const middleWidth = rect.width / 2;\n    const middleHeight = rect.height / 2;\n    const middleX = rect.left + middleWidth;\n    const middleY = rect.top + middleHeight;\n\n    const x = (middleX - event.clientX) * -1;\n    const y = middleY - event.clientY;\n\n    let finalX: number = 0,\n      finalY: number = 0;\n\n    if (config.axis.toLowerCase() !== \"y\")\n      finalX =\n        (x /\n          (this.focusElement !== this.card3dElement\n            ? window.innerWidth / 2\n            : rect.width / 2)) *\n        config.delta;\n\n    if (config.axis.toLowerCase() !== \"x\")\n      finalY =\n        (y /\n          (this.focusElement !== this.card3dElement\n            ? window.innerHeight / 2\n            : rect.height / 2)) *\n        config.delta;\n\n    //we simulate mousse position\n    if (\"gyroscopie\" in event) {\n      finalX = event.clientX * config.delta;\n      finalY = event.clientY * config.delta;\n    }\n\n    if (config.glare) {\n      const angle =\n        Math.atan2(event.clientX - middleX, -(event.clientY - middleY)) *\n        (180 / Math.PI);\n      const glareSize =\n        (rect.width > rect.height ? rect.width : rect.height) * 2;\n      this.glareElement.style.opacity = config.glareOpacity.toString();\n      this.glareElement.style.left = \"50%\";\n      this.glareElement.style.top = \"50%\";\n      this.glareElement.style.width = glareSize + \"px\";\n      this.glareElement.style.height = glareSize + \"px\";\n      this.glareElement.style.transform = `rotate(${angle}deg) translate(-50%, -50%)`;\n      this.glareElement.style.display = \"block\";\n    }\n\n    this.card3dElement.style.transform = `\n        perspective(${config.perspective}px) \n        rotateX(${finalY * reverse}deg) \n        rotateY(${finalX * reverse}deg)\n        scale(${config.scale})\n        `;\n  }\n\n  /**\n   * Event that handle when mouse out of the card\n   * @param event\n   */\n  mouseout(event: MouseEvent) {\n    this.card3dElement.style.transition = \"0.5s ease\";\n    this.card3dElement.style.transform = \"\";\n    if (this.glareElement) this.glareElement.style.opacity = \"0\";\n  }\n}\n\n/**\n * Check the card and create the card\n * @param card3dList\n * @returns\n */\nfunction Card3dAttributesHandler(\n  card3dList: HTMLElement[] | NodeListOf<HTMLElement>\n) {\n  for (const card3d of card3dList) {\n    //check element is a card3d\n    if (\n      Card3dElements.findIndex((e) => e.element === card3d) !== -1 ||\n      card3d.dataset?.card3d === undefined\n    ) {\n      continue;\n    }\n\n    //we dont create the card if by default it stopped\n    const isStopped = parseBooleanAttribute(card3d.dataset.card3dStop);\n    if (isStopped) return;\n\n    new Card3d(card3d);\n  }\n}\n\n/**\n * Create the observer to add new card, remove card or change card on attribute change\n */\nfunction Card3dObserver() {\n  const observerDOM = new MutationObserver(function (mutations) {\n    const addedNodes: HTMLElement[] = [];\n\n    for (const mutation of mutations ?? []) {\n      //attributes changed\n      if (\n        mutation.type === \"attributes\" &&\n        mutation.attributeName.includes(\"data-card3d\")\n      ) {\n        const element = mutation.target as HTMLElement;\n        const cardIndex = Card3dElements.findIndex(\n          (e) => e.element === element\n        );\n\n        if (\n          parseBooleanAttribute(element.dataset?.card3d) &&\n          cardIndex === -1\n        ) {\n          console.log(element);\n          addedNodes.push(element);\n        } else if (cardIndex !== -1) {\n          Card3dElements[cardIndex].instance.updateConfig();\n        }\n      }\n\n      //added nodes\n      for (const addedNode of mutation.addedNodes) {\n        addedNodes.push(addedNode as HTMLElement);\n      }\n\n      //nodes removed\n      for (const removedNode of mutation.removedNodes) {\n        const elementIndex = Card3dElements.findIndex(\n          (e) => e.element === (removedNode as HTMLElement)\n        );\n        if (elementIndex !== -1) {\n          Card3dElements.splice(elementIndex, 1);\n        }\n      }\n    }\n\n    if (addedNodes.length > 0) Card3dAttributesHandler(addedNodes);\n  });\n\n  observerDOM.observe(window.document.documentElement, {\n    childList: true,\n    subtree: true,\n    attributes: true,\n  });\n}\n\n//When dom loaded we init the observer and the card already present\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  Card3dAttributesHandler(document.querySelectorAll(\"[data-card3d]\"));\n  Card3dObserver();\n});\n\nexport default Card3d;\n"],"names":[],"mappings":"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"}